{% extends "base.html" %}
{% block content %}

<h2>Targets</h2>
<p>
<div id="table"></div>
</p>

<script>
    const targetLabels = {
        id: "#",
        name: "Target",
        port_open: {
            name: "Port open",
            formatter: boolFormatter,
        },
        instance_name: "Instance name",
        listable_authenticated: {
            name: "Listable (auth)",
            formatter: boolFormatter,
        },
        listable_unauthenticated: {
            name: "Listable (no auth)",
            formatter: boolFormatter,
        },
    };
    async function main(){
        const db = await initDb();
        const targets = db.exec("SELECT * FROM target")[0];
        const columns = targets.columns.map(col => {
            if (targetLabels[col]) { return targetLabels[col] }
            else { return col }
        });

        new gridjs.Grid({
            columns: columns,
            data: targets.values,
            style: {td: {'font-family': "monospace"}},
            pagination: {limit: 20},
            search: true,
            sort: true,
            resizable: true,
        }).render(document.getElementById("table"));
    };
    window.addEventListener("load", main);
</script>

{% endblock %}
